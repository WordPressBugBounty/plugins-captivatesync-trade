jQuery(document).ready(function(e){e(".cfm-color-picker").wpColorPicker();var t=[],o=[];e(document).on("click",".cfm-podcasts-picker .dropdown-menu a.dropdown-item",function(n){n.preventDefault();var a=e(this).data("id"),i=e(this).text();-1===e.inArray(a,t)?(t.push(a),e("#cfm-podcasts-selected").append('<span data-id="'+a+'" class="cfmsync-tooltip" aria-hidden="true" data-bs-placement="top" title="Click to remove">'+i+"</span>"),e("#cfm-episodes-selected").html(""),o=[]):cfmsync_toaster("error","The podcast you're trying to select is already added."),e("input[name=select_shows]").val(""),e(document).loadEpisodes(t)}),e(document).on("click","#cfm-podcasts-selected span",function(n){var a=e(this).data("id");t=e.grep(t,function(e){return e!=a}),e(this).tooltip("hide").remove(),e("#cfm-episodes-selected span").each(function(){if(e(this).data("show-id")===a){e(this).remove();var t=e(this).data("id");o=e.grep(o,function(e){return e!=t})}}),e(document).loadEpisodes(t)}),e("input[name=select_shows]").on("keyup",function(){var t=e(this).val().toLowerCase();e(".cfm-podcasts-picker .dropdown-menu a.dropdown-item").show().filter(function(){return-1===e(this).text().toLowerCase().indexOf(t)}).hide()}),e(document).on("click",".cfm-episodes-picker .dropdown-menu a.dropdown-item",function(t){t.preventDefault();var n=e(this).data("id"),a=e(this).html(),i=e(this).data("show-id");-1===e.inArray(n,o)?(o.push(n),e("#cfm-episodes-selected").append('<span data-show-id="'+i+'" data-id="'+n+'" class="cfmsync-tooltip" aria-hidden="true" data-bs-placement="top" title="Click to remove">'+a+"</span>")):cfmsync_toaster("error","The episode you're trying to select is already added."),e("input[name=select_episodes]").val("")}),e(document).on("click","#cfm-episodes-selected span",function(t){var n=e(this).data("id");o=e.grep(o,function(e){return e!=n}),e(this).tooltip("hide").remove()}),e("input[name=select_episodes]").on("keyup",function(){var t=e(this).val().toLowerCase();e(".cfm-episodes-picker .dropdown-menu a.dropdown-item").show().filter(function(){return-1===e(this).text().toLowerCase().indexOf(t)}).hide()}),e.fn.loadEpisodes=function(t){e.ajax({url:cfmsync.ajaxurl,type:"post",data:{action:"shortcode-load-episodes",_nonce:cfmsync.ajaxnonce,show_ids:t},beforeSend:function(){e(".cfm-episodes-picker .dropdown-menu").html("<span>Loading episodes...</span>")},success:function(t){e(".cfm-episodes-picker .dropdown-menu").html(t)}})},e(document).on("click","#generate_shortcode",function(n){if(0===t.length&&0===o.length)return cfmsync_toaster("error","Please select show(s) or episode(s)."),n.preventDefault(),!1;var a=t,i=o,c=e("input[name=shortcode_layout]:checked").val(),s=e("input[name=shortcode_column]:checked").val(),d=e("input[name=shortcode_title]:checked").val(),r=e("input[name=shortcode_se_num]:checked").val(),l=e("input[name=shortcode_title_tag]").val(),p=e("input[name=shortcode_title_color]").val(),h=e("input[name=shortcode_title_hover_color]").val(),m=e("input[name=shortcode_image]:checked").val(),u=e("input[name=shortcode_image_size]:checked").val(),_=e("input[name=shortcode_content]:checked").val(),v=e("input[name=shortcode_player]:checked").val(),f=e("input[name=shortcode_content_length]").val(),k=e("input[name=shortcode_items]").val(),w=e("input[name=shortcode_link]:checked").val(),y=e("input[name=shortcode_link_text]").val(),g=e("input[name=shortcode_link_text_color]").val(),x=e("input[name=shortcode_link_text_hover_color]").val(),j=e("input[name=shortcode_order]:checked").val(),C=e("input[name=shortcode_pagination]:checked").val(),L=e("input[name=shortcode_exclude]:checked").val(),b=e("input[name=shortcode_pagination_load_more_text]").val(),z=e("input[name=shortcode_pagination_load_more_class]").val(),D="";"grid"==c&&(D=' columns="'+s+'"');var E="";""!=p&&"hide"!=d&&(E=' title_color="'+p+'"');var S="";""!=h&&"hide"!=d&&(S=' title_hover_color="'+h+'"');var A="";"excerpt"==_&&(A=' content_length="'+f+'"');var O="";"show"==w&&(O=' link_text="'+y+'"');var P="";""!=g&&"hide"!=w&&(P=' link_text_color="'+g+'"');var T="";""!=x&&"hide"!=w&&(T=' link_text_hover_color="'+x+'"');var M="";"load_more"==C&&(M=' load_more_text="'+(b=""!=b?b:"Load More")+'" load_more_class="'+(z=""!=z?z:"")+'"');var Q='[cfm_captivate_episodes show_id="'+a+'" episode_id="'+i+'" layout="'+c+'" title="'+d+'" se_num="'+r+'" title_tag="'+l+'"'+D+E+S+P+T+' image="'+m+'" image_size="'+u+'" content="'+_+'" '+A+' player="'+v+'" link="'+w+'" '+O+' order="'+j+'" exclude="'+L+'" items="'+k+'" pagination="'+C+'"'+M+"]",q='[cfm_captivate_episodes show_id="'+a+'" episode_id="'+i+'" layout="'+c+'" title="'+d+'" se_num="'+r+'" title_tag="'+l+'"'+D+E+S+P+T+' image="'+m+'" image_size="'+u+'" content="'+_+'" '+A+' player="'+v+'" link="'+w+'" '+O+' order="'+j+'" exclude="'+L+'" items="6" pagination="hide" '+M+"]";e("#clipboard-shortcode").text(Q),cfmsync_toaster("success","Shortcode updated"),e.ajax({url:cfmsync.ajaxurl,type:"post",data:{action:"save-shortcode",_nonce:cfmsync.ajaxnonce,show_id:a,shortcode:Q,shortcode_preview:q},beforeSend:function(){e("#shortcode-preview").html(cfm_content_spinner)},success:function(t){e("#shortcode-preview").html(t)}})})});