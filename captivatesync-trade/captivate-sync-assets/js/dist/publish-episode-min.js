Dropzone.autoDiscover=!1,jQuery(document).ready(function(e){var t=["toplevel_page_cfm-hosting-publish-episode","admin_page_cfm-hosting-publish-episode","captivate-sync_page_cfm-hosting-publish-episode"],a=["toplevel_page_cfm-hosting-edit-episode","admin_page_cfm-hosting-edit-episode","captivate-sync_page_cfm-hosting-edit-episode"];-1!==e.inArray(cfmsync.CFMH_CURRENT_SCREEN,t)&&e("#cfm-form-publish-episode").cfmLocalStorage({exclude_name:["_sec","_wp_http_referer"],interval:432e5});var o=e("input[name=show_id]").val(),s=e("input[name=media_created_at]"),r=e("input[name=media_id]"),n=e("input[name=media_bit_rate]"),d=e("input[name=media_bit_rate_str]"),l=e("input[name=media_duration]"),c=e("input[name=media_duration_str]"),p=e("input[name=media_id3_size]"),u=e("input[name=media_name]"),f=e("input[name=media_size]"),m=e("input[name=media_type]"),h=e("input[name=media_url]"),v=e("input[name=media_shows_id]"),_=e("input[name=media_updated_at]"),g=e("input[name=media_users_id]");function b(t){new Date>new Date(t)?(e("button[name=episode_publish]").html("Publish Episode"),e("button[name=episode_update]").html("Update Episode")):(e("button[name=episode_publish]").html("Schedule Episode"),e("button[name=episode_update]").html("Schedule Episode"))}e("#podcast-dropzone").dropzone({autoProcessQueue:!0,uploadMultiple:!1,parallelUploads:1,maxFiles:1,maxFilesize:300,timeout:5e5,url:cfm_script.cfm_url+"/shows/"+o+"/media",acceptedFiles:".mp3, .mp4, .m4a",addRemoveLinks:!0,dictDefaultMessage:'<i class="far fa-waveform"></i><div class="dz-content">Drag and drop your audio file* <br> or <strong>browse files</strong><small>MP3, M4A, MP4 file types</small></div>',init:function(){var a=this;if(existingFile=h.val(),existingFile){var i={name:existingFile.replace(/^.*[\\\/] /,""),size:1,status:"success",accepted:!0,processing:!0};a.files.push(i)}a.on("addedfile",function(t){var i=t.size,o=a.files.length;i>314572800&&cfmsync_toaster("error","Audio file maximum allowed size exceeded (300MB)."),o>1&&e.each(a.files,function(e,t){e<o-1&&a.removeFile(t)})}),a.on("sending",function(e,t,a){let i=cfm_script.xfNr5Wsp;i=(i=i.slice(29)).slice(0,-29),t.setRequestHeader("Authorization","Bearer "+i)}),a.on("processing",function(t,a){e("#cfm-audio-uploader .dropzone-uploader").fadeOut(100,function(){e("#cfm-audio-uploader .dropzone-preloader").show(),e("#cfm-audio-uploader .progress-info").html("Uploading <strong>"+t.upload.filename+"</strong>"),e("#cfm-audio-uploader .dropzone-result").html(""),e("#episode_draft, #episode_update").prop("disabled",!0)})}),a.on("uploadprogress",function(t,a,i){e("#cfm-audio-uploader .progress-bar").css("width",a+"%")}),a.on("success",function(i,o){var b=o.media,w=String(b.media_bit_rate);s.val(b.created_at),r.val(b.id),n.val(b.media_bit_rate),d.val(w.substring(0,3)+"kbps"),l.val(b.media_duration),c.val(cfm_milliseconds_to_str(1e3*b.media_duration)),p.val(b.media_id3_size),u.val(b.media_name),f.val(b.media_size),m.val(b.media_type),h.val(b.media_url),v.val(b.shows_id),_.val(b.updated_at),g.val(b.users_id),e("input[name=media_id]").trigger("change"),e("#cfm-audio-uploader .dropzone-preloader").fadeOut(100,function(){e("#cfm-audio-uploader .dropzone-result").html('<audio controls="controls" preload="none"><source type="audio/mpeg" src="'+b.media_url+'"> Your browser does not support the audio element. </audio><div class="dropzone-result-info d-flex justify-content-between"><div class="result-info"><strong>'+b.media_name+"</strong> <br>"+w.substring(0,3)+"kbps | "+cfm_milliseconds_to_str(1e3*b.media_duration)+'</div><div class="result-actions"><button class="replace-audio btn btn-outline-dark">Replace audio file</button></div></div>')}),cfmsync_toaster("success","Audio file successfully uploaded to your episode."),$episode_publish_text=!0===cfm_is_datetime_future(e("input[name=publish_date]").val()+" "+e("input[name=publish_time]").val())?"Schedule Episode":"Publish Episode",e("#episode_update").length||($episode_publish_id=-1!==e.inArray(cfmsync.CFMH_CURRENT_SCREEN,t)?"episode_publish":"episode_update",e("#cfm-episode-save").html('<button type="submit" id="episode_draft" name="episode_draft" class="btn btn-primary full-md-button me-3">Save As Draft</button><button type="submit" id="'+$episode_publish_id+'" name="'+$episode_publish_id+'" class="btn btn-primary full-md-button" >'+$episode_publish_text+"</button>")),e("#episode_draft, #episode_update").prop("disabled",!1),a.removeAllFiles(!0)}),a.on("error",function(t,i){e("#cfm-audio-uploader .dropzone-preloader").fadeOut(100,function(){e("#cfm-audio-uploader .dropzone-result").html('<div class="cfm-alert cfm-alert-error"><span class="alert-icon"></span> <span class="alert-text">Media file upload error</span></div>'),e("#cfm-audio-uploader .dropzone-uploader").show()}),a.removeAllFiles(!0)})}}),e(document).on("click","#cfm-audio-uploader .cancel-upload",function(t){t.preventDefault(),e("#cfm-audio-uploader .dropzone-preloader").fadeOut(100,function(){e("#cfm-audio-uploader .dropzone-uploader").show(),e("#cfm-audio-uploader .progress-info").html(""),e("#cfm-audio-uploader .progress-bar").css("width","0")}),Dropzone.forElement("#podcast-dropzone").off("error"),Dropzone.forElement("#podcast-dropzone").removeAllFiles(!0)}),e(document).on("click","#cfm-audio-uploader .replace-audio",function(t){t.preventDefault(),e("#cfm-audio-uploader .dropzone-result").html(""),e("#cfm-audio-uploader .dropzone-uploader").show(),Dropzone.forElement("#podcast-dropzone").removeAllFiles(!0)}),e("#post_title_check").change(function(){e("#post_title_check:checked").length==e("#post_title_check").length?e(".cfm-field.cfm-itunes-title").fadeIn(200):e(".cfm-field.cfm-itunes-title").fadeOut(200)}),e("input[name=publish_date]").datepicker({changeMonth:!0,changeYear:!0,showOtherMonths:!0,selectOtherMonths:!0,defaultDate:new Date,dateFormat:"mm/dd/yy",dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],onSelect:function(t){b(t+" "+e("input[name=publish_time]").val()),e("input[name=publish_date]").trigger("change")}}),e(document).on("click",".cfm-datepicker .input-group .btn",function(t){t.preventDefault(),e("input[name=publish_date]").focus()}),e(document).on("click",".cfm-timepicker .dropdown-menu a.dropdown-item",function(t){var a=e(this).text();b(e("input[name=publish_date]").val()+" "+a),e("input[name=publish_time]").val(a),e("input[name=publish_time]").trigger("change")}),e(document).on("click","#artwork-dropzone",function(t){var a;t.preventDefault(),$this=e(this),a&&a.open(),(a=wp.media({title:"Select Episode Cover Art",multiple:!1,library:{type:"image"}})).on("select",function(){var t=a.state().get("selection"),i=0;if(0==i&&t.each(function(e){i=e.id}),0!=i){var o=a.state().get("selection").first().toJSON();o.url&&(e("#episode_artwork").val(o.url),e("#episode_artwork_id").val(i),e("#episode_artwork_width").val(o.width),e("#episode_artwork_height").val(o.height),e("#episode_artwork_type").val(o.mime),e("#episode_artwork_filesize").val(o.filesizeInBytes),e("#episode_artwork, #episode_artwork_id, #episode_artwork_width, #episode_artwork_height, #episode_artwork_type, #episode_artwork_filesize").trigger("change"),$this.parent().hide(),e("#cfm-artwork-uploader .fd-replace").fadeIn(200),e("#cfm-artwork-uploader .fd-result").html('<img src="'+o.url+'" width="200" height="200" class="img-fluid">').hide().fadeIn(650))}}),a.on("open",function(){var t=a.state().get("selection");ids=e("#episode_artwork_id").val().split(","),ids.forEach(function(e){attachment=wp.media.attachment(e),attachment.fetch(),t.add(attachment?[attachment]:[])})}),a.open()}),e(document).on("click","#cfm-artwork-uploader .remove-image",function(t){t.preventDefault(),e("#cfm-artwork-uploader .fd-replace").fadeOut(100,function(){e("#cfm-artwork-uploader .fd-uploader").show(),e("#cfm-artwork-uploader .fd-result").html('<i class="fal fa-image"></i>'),e("#episode_artwork").val(""),e("#episode_artwork_id").val(""),e("#episode_artwork_width").val(""),e("#episode_artwork_height").val(""),e("#episode_artwork_type").val(""),e("#episode_artwork_filesize").val(""),e("#episode_artwork, #episode_artwork_id, #episode_artwork_width, #episode_artwork_height, #episode_artwork_type, #episode_artwork_filesize").trigger("change")})}),e(document).on("click","#cfm-artwork-uploader .upload-new-image",function(t){t.preventDefault(),e("#cfm-artwork-uploader .fd-replace").fadeOut(100,function(){e("#cfm-artwork-uploader .fd-uploader").show()})}),e(document).on("click","#featured-image-dropzone",function(a){var i;a.preventDefault(),$this=e(this),i&&i.open(),(i=wp.media({title:"Select Website Featured Image",multiple:!1,library:{type:"image"}})).on("select",function(){var a=i.state().get("selection"),o=0;if(0==o&&a.each(function(e){o=e.id}),0!=o){var s=i.state().get("selection").first().toJSON();s.url&&(e("#featured_image").val(o),e("#featured_image").trigger("change"),$this.parent().hide(),e("#cfm-featured-image-uploader .fd-replace").fadeIn(200),e("#cfm-featured-image-uploader .fd-result").html('<img src="'+s.url+'" width="200" height="200" class="img-fluid">').hide().fadeIn(650),-1!==e.inArray(cfmsync.CFMH_CURRENT_SCREEN,t)&&localStorage.setItem(cfmsync.CFMH_SHOWID+"_featured_image_url_local",s.url))}}),i.open()}),e(document).on("click","#cfm-featured-image-uploader .remove-image",function(t){t.preventDefault(),e("#cfm-featured-image-uploader .fd-replace").fadeOut(100,function(){e("#cfm-featured-image-uploader .fd-uploader").show(),e("#cfm-featured-image-uploader .fd-result").html('<i class="fal fa-image"></i>'),e("#featured_image").val("0"),e("#featured_image").trigger("change")}),localStorage.removeItem(cfmsync.CFMH_SHOWID+"_featured_image_url_local")}),e(document).on("click","#cfm-featured-image-uploader .upload-new-image",function(t){t.preventDefault(),e("#cfm-featured-image-uploader .fd-replace").fadeOut(100,function(){e("#cfm-featured-image-uploader .fd-uploader").show()})}),e(document).on("click","#enable_wordpress_editor",function(t){this.checked?(e(".cfm-captivate-editor").addClass("hidden"),e(".cfm-wordpress-editor").removeClass("hidden")):(e(".cfm-captivate-editor").removeClass("hidden"),e(".cfm-wordpress-editor").addClass("hidden"))}),e(window).keydown(function(e){if(13==e.keyCode&&"textarea"!=e.target.tagName.toLowerCase())return e.preventDefault(),!1});var w=null;if(e(document).on("submit","#cfm-form-publish-episode",function(t){var a=e("#"+w),i=a.html();e("button[type=submit]").prop("disabled",!0),a.html('<i class="fas fa-spinner fa-spin me-2"></i> Processing...'),e("#episode-cancel").addClass("disabled");var o=e("input[name=post_title]").val(),s=e("textarea[name=post_content]").val(),r=e("#seo_description").val(),n=0,d="";if(""==e("input[name=media_id]").val()&&"episode_draft"!=w&&(e("#cfm-audio-uploader").addClass("invalid-control"),e("#cfm-audio-uploader-error").length||e('<div id="cfm-audio-uploader-error" class="invalid-feedback">You must upload an audio for your episode.</div>').insertAfter("#cfm-audio-uploader"),n+=1,d+="<br>You must upload an audio for your episode.<br>"),""==o&&(e("input[name=post_title]").addClass("is-invalid"),e("#post_title-error").length||e('<div id="post_title-error" class="invalid-feedback">You must enter a title for your episode.</div>').insertAfter("input[name=post_title]"),n+=1,d+="<br>Episode Title: Check for any unusual or invalid characters, remove and resave.<br>"),""!=s&&"<p><br></p>"!=s||!e(".cfm-captivate-editor").is(":visible")||"episode_draft"==w||(e("#cfm-field-wpeditor").addClass("invalid-control is-invalid"),e(".cfm-episode-shownotes .ql-toolbar.ql-snow").addClass("is-invalid"),e("#captivate-shownotes-error").length||e('<div id="captivate-shownotes-error" class="invalid-feedback">You must enter show notes for your episode.</div>').insertAfter("#cfm-field-wpeditor"),n+=1,d+="<br>Episode Show NOTES: Check for any unusual or invalid characters, remove and resave.<br>"),e(".cfm-wordpress-editor").is(":visible")&&"episode_draft"!=w){var l="";if(e("#wp-post_content_wp-wrap").hasClass("html-active"))l=e("#post_content_wp").val();else l=tinymce.get("post_content_wp").getContent();""==l&&(e("#wp-post_content_wp-wrap").addClass("invalid-control"),e("#wp-shownotes-error").length||e('<div id="wp-shownotes-error" class="invalid-feedback">You must enter show notes for your episode.</div>').insertAfter("#wp-post_content_wp-wrap"),n+=1,d+="<br>Episode Show NOTES: Check for any unusual or invalid characters, remove and resave.<br>")}r.length>300&&(e("#seo_description").addClass("is-invalid"),n+=1,d+="<br>SEO Description: length must be less than or equal to 300 characters long.<br>");var c=e("input[name=episode_artwork_id]").val(),p=e("input[name=episode_artwork_width]").val(),u=e("input[name=episode_artwork_height]").val(),f=e("input[name=episode_artwork_type]").val(),m=e("input[name=episode_artwork_filesize]").val();if(""!=c&&(p!=u||p<1400||p>3e3||u<1400||u>3e3||m>5e5||"image/jpeg"!=f&&"image/jpg"!=f&&"image/png"!=f)&&(e("#cfm-artwork-uploader").addClass("invalid-control"),e("#cfm-artwork-uploader-error").length||e('<div id="cfm-artwork-uploader-error" class="invalid-feedback mt-4">Your artwork should be a minimum of 1,400 pixels square and a maximum of 3,000 pixels square with less than 500kb in filesize. Both height and width must be the same.</div>').insertAfter("#cfm-artwork-uploader"),n+=1,d+="<br>Episode Artwork: Follow the artwork specifications, remove and reupload.<br>"),e(this).validateACF()||(e("#acf-fields").addClass("is-invalid"),e("#acf-fields-error").length||e(".cfm-website-acf").append('<div id="acf-fields-error" class="invalid-feedback">There is an issue with some of your ACF fields.</div>'),n+=1,d+="<br>ACF: There is an issue with some of your fields.<br>"),n>0)return cfmsync_toaster("error","<strong>Could not save - a setting is invalid</strong>"+d),e("button[type=submit]").prop("disabled",!1),e("#episode-cancel").removeClass("disabled"),a.html(i),t.preventDefault(),!1}),e(document).on("click",'button[name="episode_draft"]',function(t){w="episode_draft",e('input[name="submit_action"]').val("draft")}),e(document).on("click",'button[name="episode_update"]',function(t){w="episode_update",e('input[name="submit_action"]').val("update")}),e(document).on("click",'button[name="episode_publish"]',function(t){w="episode_publish",e('input[name="submit_action"]').val("publish")}),e(document).on("keyup","#post_title",function(t){""!=e(this).val()&&(e(this).removeClass("is-invalid"),e("#post_title-error").remove())}),"on"==e("#enable_wordpress_editor").val())if(e("#wp-post_content_wp-wrap").hasClass("html-active"))e(document).on("keyup","#post_content_wp",function(t){""!=e(this).val()&&(e("#wp-post_content_wp-wrap").removeClass("invalid-control is-invalid"),e("#wp-shownotes-error").remove())});else{var y=tinymce.get("post_content_wp");null!==y&&y.on("keyup",function(t){e("#wp-post_content_wp-wrap").removeClass("invalid-control is-invalid"),e("#wp-shownotes-error").remove()})}e(document).on("keyup","#seo_description",function(t){var a=e(this).val().length<155?e(this).val().length/155*100:100,i="orange";a>=50&&a<=99?i="#29ab57":a>=100&&(i="#dc3545"),e(".cfm-seo-description-progress").css("background-color",i),e(".cfm-seo-description-progress").css("width",a+"%")}),e(document).on("focus","#post_title.post-title-empty",function(t){$this=e(this),$this.blur(function(){$this.hasClass("post-title-empty")&&(e("input[name=post_name]").val(cfm_convert_to_slug($this.val())),""!=$this.val()&&$this.removeClass("post-title-empty"))})}),e(document).on("keyup","input[name=post_name]",function(t){e(this).val(cfm_convert_to_slug(e(this).val()))}),e(document).on("click","#add-website-category",function(t){t.preventDefault();var a=e("select[name=category_parent]").val(),i=e("input[name=website_category]").val();""!=i?e.ajax({url:cfmsync.ajaxurl,type:"post",dataType:"json",data:{action:"add-webcategory",category_parent:a,category:i,_nonce:cfmsync.ajaxnonce},success:function(t){"error"==t?cfmsync_toaster("error","Something went wrong. Please refresh the page and try again."):(e(".cfm-website-categories-wrap > ul").prepend(t.cat_checklist),e(".cfm-category-parent").html(t.cat_parent),e("select[name=category_parent]").prop("selectedIndex",0),e("input[name=website_category]").val(""),cfmsync_toaster("success","Category has been successfully added and selected."))},error:function(e){cfmsync_toaster("error","Category already exists.")}}):e("input[name=website_category]").addClass("is-invalid is-sub-validation").focus(),t.preventDefault()}),e(document).on("click","#add-website-tags",function(t){t.preventDefault();var a=e("input[name=website_tags]").val(),o=a.split(","),s=[],r=[],n=[];for(i=0;i<o.length;i++)r.push(e.trim(o[i].toLowerCase()));for(e(".cfm-website-tags-wrap ul li label").each(function(){var t=e.trim(e(this).text().toLowerCase());-1!==e.inArray(t,r)&&e(this).find("input[type=checkbox]").prop("checked",!0),n.push(t)}),i=0;i<o.length;i++){var d=e.trim(o[i].toLowerCase());-1==e.inArray(d,n)&&s.push(e.trim(o[i]))}0!==s.length?e.ajax({url:cfmsync.ajaxurl,type:"post",data:{action:"add-webtags",tags:s.toString(),_nonce:cfmsync.ajaxnonce},success:function(t){"error"==t?cfmsync_toaster("error","Something went wrong. Please refresh the page and try again."):(e(".cfm-website-tags-wrap > ul").prepend(t),e("input[name=website_tags]").val(""),cfmsync_toaster("success","Tag(s) has been successfully added and selected."))}}):e("input[name=website_tags]").val(""),""==a&&e("input[name=website_tags]").addClass("is-invalid is-sub-validation").focus(),t.preventDefault()});var k="input[name=transcript_file]",C="textarea[name=transcript_text]",x="textarea[name=transcript_current]",S='<a id="transcript-add" data-bs-toggle="modal" data-bs-target="#transcript-modal" href="#"><i class="fal fa-file-alt me-2"></i> Add a transcript to this episode </a>',z='<div class="transcript-text">Have a transcript file? Upload it directly... </div><a id="upload-transcript" href="javascript: void(0);"><i class="fal fa-cloud-upload" aria-hidden="true"></i> Upload File</a>';e(document).on("click","#upload-transcript",function(t){e(k).focus().trigger("click")}),e(document).on("click","#update-transcript",function(t){if(0===e(k).get(0).files.length){if(""!=e(C).val())var a="<strong>"+cfm_truncate(e(C).val(),20)+'</strong> <a id="cfm-transcript-edit" class="float-end" data-bs-toggle="modal" data-bs-target="#transcript-modal" href="#"><i class="fal fa-edit"></i> Edit</a><div class="mt-2"><a id="transcript-remove" class="transcript-remove text-danger" href="javascript: void(0);"><i class="fal fa-trash-alt"></i> Remove</a></div>';else a=S;e(x).val(e(C).val()),e("input[name=transcript_type]").val("text")}else{var i=e(k).val().replace(/C:\\fakepath\\/i,"");a="<strong>"+i+'</strong> <a id="cfm-transcript-edit" class="float-end" data-bs-toggle="modal" data-bs-target="#transcript-modal" href="#"><i class="fal fa-undo fa-flip-horizontal"></i> Replace</a><div class="mt-2"><a id="transcript-remove" class="transcript-remove text-danger" href="javascript: void(0);"><i class="fal fa-trash-alt"></i> Remove</a></div>';e(x).val(i),e("input[name=transcript_type]").val("file")}e("input[name=transcript_updated]").val("1"),e(".cfm-episode-transcription .cmf-transcript-wrap").html(a),e("#transcript-modal").modal("hide")}),e(document).on("click","#cancel-transcript, #close-transcript",function(t){"file"==e("input[name=transcript_type]").val()?(e(C).val(""),e(".transcript-upload-box").html('<div class="transcript-text">File uploaded: <strong>'+e(x).val()+'</strong></div><a id="remove-transcript-file" class="text-danger" href="javascript: void(0);"><i class="fal fa-trash-alt"></i> Remove</a>'),e(C).prop("disabled",!0),e(".transcript-upload-box").removeClass("disabled")):(e(C).val(e(x).val()),e(".transcript-upload-box").html(z),e(".transcript-upload-box").addClass("disabled"),e(C).prop("disabled",!1))}),e(document).on("click","#transcript-remove",function(t){e(C).val(""),e(k).val(""),e(x).val(""),e("input[name=transcript_updated]").val("1"),e(C).prop("disabled",!1),e(".transcript-upload-box").removeClass("disabled"),e(".cfm-episode-transcription .cmf-transcript-wrap").html(S),e(".transcript-upload-box").html(z)}),e(document).on("change keyup",C,function(t){""!=e(this).val()?e(".transcript-upload-box").addClass("disabled"):e(".transcript-upload-box").removeClass("disabled")}),e(document).on("change",k,function(t){if(0===e(this).get(0).files.length)e(C).prop("disabled",!1),e(".transcript-upload-box").html(z);else{var a=e(this).val().replace(/C:\\fakepath\\/i,"");e(C).prop("disabled",!0),e(".transcript-upload-box").html('<div class="transcript-text">File uploaded: <strong>'+a+'</strong></div><a id="remove-transcript-file" class="text-danger" href="javascript: void(0);"><i class="fal fa-trash-alt"></i> Remove</a>')}}),e(document).on("click","#remove-transcript-file",function(t){e(k).val(""),e(k).trigger("change")}),e(window).load(function(){!0===cfm_is_datetime_future(e("input[name=publish_date]").val()+" "+e("input[name=publish_time]").val())&&e("button[name=episode_update] , button[name=episode_publish]").html("Schedule Episode")}),e(document).on("keyup",".form-control.is-invalid",function(t){""!=e(this).val()&&e(this).removeClass("is-invalid is-sub-validation")}),e(document).on("focus",".form-control.is-sub-validation",function(t){e(this).blur(function(){e(this).removeClass("is-invalid is-sub-validation")})}),e(document).on("click","#cfm-duplicate-episode",function(t){t.preventDefault();var a=e(this),i=a.html(),o=a.attr("data-reference"),s=a.attr("data-nonce");e.ajax({url:cfmsync.ajaxurl,type:"post",data:{action:"duplicate-episode",_nonce:s,post_id:o},dataType:"json",beforeSend:function(){a.prop("disabled",!0),a.siblings("button").prop("disabled",!0),a.html('<i class="fas fa-spinner fa-spin me-2"></i> Duplicating episode...')},success:function(t){a.prop("disabled",!1),a.siblings("button").prop("disabled",!1),a.html(i),e("#confirmation-modal").modal("hide"),"success"==t.output?(cfmsync_toaster("success",t.message),window.location.replace(t.redirect_url)):cfmsync_toaster("error",t.message)}}),t.preventDefault()}),e("#acf-modal").on("hide.bs.modal",function(t){e(this).validateACF()?(e("#acf-fields").removeClass("is-invalid"),e(".cfm-website-acf").find(".acf-fields-error").remove()):t.preventDefault()}),e.fn.validateACF=function(){var t=0;return e(".modal-field-groups-wrap .acf-field").each(function(){var a="",i=e(this).hasClass("required");if(e(this).find(".switch-html").click(),e(this).find('input[type="text"], input[type="number"], input[type="range"], input[type="email"], input[type="url"]').length?a=e(this).find("input").val():e(this).find("textarea").length?a=e(this).find("textarea").val():e(this).find("select").length?a=e(this).find("select").val():e(this).find('input[type="radio"]:checked').length?a=e(this).find('input[type="radio"]:checked').val():e(this).find(".acf-wysiwyg-container").length&&(a=tinymce.get(e(this).find(".wp-editor-area")).getContent()),e(this).find(".switch-tmce").click(),i&&!a)e(this).addClass("is-invalid"),t+=1,e(this).find(".acf-field-feedback").length||e(this).append('<div class="acf-field-feedback invalid-feedback">This field is required.</div>');else if(e(this).find("input, textarea").attr("maxlength")){var o=parseInt(e(this).find("input, textarea").attr("maxlength"));a.length>o?(e(this).addClass("is-invalid"),t+=1,e(this).find(".acf-field-feedback").length||e(this).append('<div class="acf-field-feedback invalid-feedback">This field cannot exceed '+o+" characters.</div>")):(e(this).removeClass("is-invalid"),e(this).find(".acf-field-feedback").remove())}else e(this).removeClass("is-invalid"),e(this).find(".acf-field-feedback").remove();if(e(this).hasClass("acf-field-type-email")&&(i||a)&&(cfm_validate_email(a)?(e(this).removeClass("is-invalid"),e(this).find(".acf-field-feedback").remove()):(e(this).addClass("is-invalid"),t+=1,e(this).find(".acf-field-feedback").length?e(this).find(".acf-field-feedback").html("Please enter a valid email address."):e(this).append('<div class="acf-field-feedback invalid-feedback">Please enter a valid email address.</div>'))),e(this).hasClass("acf-field-type-number")&&(i||a)){var s=e(this).find("input"),r=parseFloat(s.attr("min")),n=parseFloat(s.attr("max")),d=parseFloat(s.attr("step"));a<r?(t+=1,e(this).addClass("is-invalid"),e(this).find(".acf-field-feedback").length||e(this).append('<div class="acf-field-feedback invalid-feedback">The value must be greater than or equal to '+r+".</div>")):a>n?(t+=1,e(this).addClass("is-invalid"),e(this).find(".acf-field-feedback").length||e(this).append('<div class="acf-field-feedback invalid-feedback">The value must be less than or equal to '+n+".</div>")):!isNaN(d)&&d>0&&a%d!=0?(t+=1,e(this).addClass("is-invalid"),e(this).find(".acf-field-feedback").length||e(this).append('<div class="acf-field-feedback invalid-feedback">The value must be a multiple of '+d+".</div>")):(e(this).removeClass("is-invalid"),e(this).find(".acf-field-feedback").remove())}(e(this).hasClass("acf-field-type-url")||e(this).hasClass("acf-field-type-oembed"))&&(i||a)&&(cfm_validate_url(a)?(e(this).removeClass("is-invalid"),e(this).find(".acf-field-feedback").remove()):(e(this).addClass("is-invalid"),t+=1,e(this).find(".acf-field-feedback").length?e(this).find(".acf-field-feedback").html("Please enter a valid URL."):e(this).append('<div class="acf-field-feedback invalid-feedback">Please enter a valid URL.</div>')))}),!(t>0)||(e(".modal-body-acf").animate({scrollTop:e(".is-invalid").first().offset().top-e(".modal-body-acf").offset().top+e(".modal-body-acf").scrollTop()-100},500),!1)},e(".cfm-insert-variable-modal").on("show.bs.modal",function(t){var a=e(t.relatedTarget),i=a.data("confirmation-reference"),o=a.data("type"),s=e(this);s.find(".modal-body input[name=dt_type]").val(["dynamic"]),s.find(".modal-footer .modal-confirm").attr("data-reference",i),s.find(".modal-footer .modal-confirm").attr("data-type",o)}),e(".cfm-insert-variable-modal").on("hidden.bs.modal",function(t){var a=e(this);a.find(".modal-footer .modal-confirm").removeAttr("data-reference"),a.find(".modal-footer .modal-confirm").removeAttr("data-type")}),-1!==e.inArray(cfmsync.CFMH_CURRENT_SCREEN,t)&&setInterval(function(){if("on"==e(document).cfmGetLocalStorage("cfm-form-publish-episode","enable_wordpress_editor")){tinymce.triggerSave();var t="";if(e("#wp-post_content_wp-wrap").hasClass("html-active"))t=e("#post_content_wp").val();else{var a=tinymce.get("post_content_wp");null!==a&&(t=a.getContent())}localStorage.setItem(cfmsync.CFMH_SHOWID+"_post_content_wp_local",t)}},5e3),e(window).load(function(){if(e(".cfm-shownotes-editor").fadeIn(),-1!==e.inArray(cfmsync.CFMH_CURRENT_SCREEN,t)){const t=e(document).cfmGetLocalStorage("cfm-form-publish-episode","enable_wordpress_editor"),a=localStorage.getItem(cfmsync.CFMH_SHOWID+"_post_content_wp_local"),o=e(document).cfmGetLocalStorage("cfm-form-publish-episode","media_url"),s=e(document).cfmGetLocalStorage("cfm-form-publish-episode","media_name"),r=e(document).cfmGetLocalStorage("cfm-form-publish-episode","media_bit_rate_str"),n=e(document).cfmGetLocalStorage("cfm-form-publish-episode","media_duration_str");if("on"==t&&e("#enable_wordpress_editor").trigger("click"),"on"==t&&""!=a&&void 0!==a&&null!==a)if(e("#wp-post_content_wp-wrap").hasClass("html-active"))e("#post_content_wp").val(a);else{var i=tinymce.get("post_content_wp");null!==i&&i.setContent(a)}""!=o&&void 0!==o&&null!==o&&(e("#cfm-audio-uploader .dropzone-uploader").hide(),e("#cfm-audio-uploader .dropzone-result").html('<audio controls="controls" preload="none"><source type="audio/mpeg" src="'+o+'"> Your browser does not support the audio element. </audio><div class="dropzone-result-info d-flex justify-content-between"><div class="result-info"><strong>'+s+"</strong> <br>"+r+" | "+n+'</div><div class="result-actions"><button class="replace-audio btn btn-outline-dark">Replace audio file</button></div></div>'),e("#episode_draft, #episode_update").prop("disabled",!1));const d=e(document).cfmGetLocalStorage("cfm-form-publish-episode","episode_artwork");""!=d&&void 0!==d&&null!==d&&(e("#cfm-artwork-uploader .fd-uploader").hide(),e("#cfm-artwork-uploader .fd-replace").show(),e("#cfm-artwork-uploader .fd-result").html('<img src="'+d+'" width="200" height="200" class="img-fluid">'));const l=localStorage.getItem(cfmsync.CFMH_SHOWID+"_featured_image_url_local");""!=l&&void 0!==l&&null!==l&&(e("#cfm-featured-image-uploader .fd-uploader").hide(),e("#cfm-featured-image-uploader .fd-replace").show(),e("#cfm-featured-image-uploader .fd-result").html('<img src="'+l+'" width="200" height="200" class="img-fluid">'));const c=e(document).cfmGetLocalStorage("cfm-form-publish-episode","itunes_title");""!=c&&void 0!==c&&null!==c?(e("input[name=post_title_check]").prop("checked",!0),e(".cfm-itunes-title").show()):e("input[name=post_title_check]").prop("checked",!1),e("select[name=category_parent]").val("-1"),e("input[name=website_category]").val(""),e("input[name=website_tags]").val("")}if(-1!==e.inArray(cfmsync.CFMH_CURRENT_SCREEN,a)){var o=cfm_get_url_vars().action,s=cfm_get_url_vars().eid;if("published"==o||"failed"==o){var r=cfmsync.CFMH_SHOWID+"_cfm-form-publish-episode_save_storage";localStorage.removeItem(r),localStorage.removeItem(cfmsync.CFMH_SHOWID+"_featured_image_url_local"),localStorage.removeItem(cfmsync.CFMH_SHOWID+"_post_content_wp_local"),localStorage.removeItem(cfmsync.CFMH_SHOWID+"_shownotes_local"),localStorage.removeItem(cfmsync.CFMH_SHOWID+"_shownotes_local_html");var n=cfmsync.CFMH_ADMINURL+"admin.php?page=cfm-hosting-edit-episode&show_id="+cfmsync.CFMH_SHOWID+"&eid="+s;setTimeout(function(){window.history.pushState(null,null,n)},2e3)}}})});